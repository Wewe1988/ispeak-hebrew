
<!DOCTYPE html><html w-tid="0"><head w-tid="1"><base href simulated-href="https://example.com" w-tid="2"/>
  <link rel="stylesheet" href="https://api.websim.ai/fonts.css?v=895643ecd8dc4e1e4a9ebcc26efc6dac95bd8ddb">
  <link rel="stylesheet" href="https://api.websim.ai/ctxmenu.css?v=895643ecd8dc4e1e4a9ebcc26efc6dac95bd8ddb">
  <script class="websim-injected">__WEBSIM_DATA__={"locationKey":"_etialh0b56l","titleKey":"_c1lo0rg0z89","id":"GsOmVyHhCkpcFa3ZO","url":"","hostOrigin":"https://websim.ai","features":{"context":true,"errors":true,"htmx":true,"images":false,"navigation":false},"prompt":{"type":"plaintext","text":"function doGet(e) {\n  var action = e.parameter.action;\n  var id = e.parameter.id;\n  var email = decodeURIComponent(e.parameter.email || '');\n\n  if (!action || !id || !email) {\n    return ContentService.createTextOutput(\"חסרים פרמטרים\").setMimeType(ContentService.MimeType.TEXT);\n  }\n\n  var userData = PropertiesService.getScriptProperties().getProperty(id);\n  if (!userData) {\n    return ContentService.createTextOutput(\"בקשה לא נמצאה\").setMimeType(ContentService.MimeType.TEXT);\n  }\n\n  userData = JSON.parse(userData);\n\n  if (action === \"approve\") {\n    MailApp.sendEmail({\n      to: email,\n      subject: \"אישור גישה למערכת ISpeak\",\n      htmlBody: `\n        \u003cdiv dir=\"rtl\"\u003e\n          \u003ch2\u003eבקשתך אושרה!\u003c/h2\u003e\n          \u003cp\u003eשלום ${userData.name},\u003c/p\u003e\n          \u003cp\u003eבקשתך לגישה למערכת ISpeak אושרה.\u003c/p\u003e\n          \u003cp\u003e\u003ca href=\"https://wewe1988.github.io/ispeak-hebrew/\"\u003eכניסה למערכת\u003c/a\u003e\u003c/p\u003e\n        \u003c/div\u003e\n      `\n    });\n    return ContentService.createTextOutput(\"הגישה אושרה\").setMimeType(ContentService.MimeType.TEXT);\n  }\n\n  if (action === \"deny\") {\n    MailApp.sendEmail({\n      to: email,\n      subject: \"דחיית בקשת גישה למערכת ISpeak\",\n      htmlBody: `\n        \u003cdiv dir=\"rtl\"\u003e\n          \u003ch2\u003eבקשתך נדחתה\u003c/h2\u003e\n          \u003cp\u003eשלום ${userData.name},\u003c/p\u003e\n          \u003cp\u003eלצערנו, בקשתך לגישה למערכת ISpeak נדחתה.\u003c/p\u003e\n        \u003c/div\u003e\n      `\n    });\n    return ContentService.createTextOutput(\"הבקשה נדחתה\").setMimeType(ContentService.MimeType.TEXT);\n  }\n}"}}</script>
  <script class="websim-injected" src="https://api.websim.ai/dist/index.js?v=895643ecd8dc4e1e4a9ebcc26efc6dac95bd8ddb"></script>
  
  <title w-tid="3">ISpeak - ^2ב2ר2י4ת מערכת</title>
  <meta charset="UTF-8" w-tid="4"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" w-tid="5"/>
  <meta http-equiv="Content-Language" content="he" w-tid="6"/>
  <meta name="google-site-verification" content="YOUR-VERIFICATION-CODE" w-tid="7"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" w-tid="8"/>
  <style w-tid="9">
  :root {
    --primary: #2b4d7e;
    --secondary: #4CAF50;
    --background: #f5f5f5;
    --text: #333;
    direction: rtl;
  }
  
  * {
    box-sizing: border-box;
    font-family: 'Heebo', sans-serif;
  }
  
  body {
    margin: 0;
    padding: 20px;
    background: var(--background);
    color: var(--text);
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    padding-right: 220px;
    padding-top: 80px;
  }
  
  .welcome-screen {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
    text-align: center;
  }
  
  .login-form {
    max-width: 500px;
    margin: 2rem auto;
  }
  
  .form-group {
    margin-bottom: 1rem;
  }
  
  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
  }
  
  .form-group input {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px; /* Prevent iOS zoom on input focus */
  }
  
  .start-button {
    background: var(--primary);
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1.1rem;
    margin-top: 1rem;
    background: linear-gradient(45deg, var(--primary), #1a365d);
    box-shadow: 0 4px 15px rgba(43, 77, 126, 0.2);
  }
  
  .nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    background: var(--primary);
    color: white;
    border-radius: 8px;
  }
  
  .exam-timer {
    position: fixed; 
    top: 20px;
    right: 220px;
    background: rgba(255, 255, 255, 0.95);
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    z-index: 1000;
    border: 2px solid var(--primary);
    min-width: 120px;
    text-align: center;
    font-weight: bold;
    backdrop-filter: blur(5px);
    width: 150px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: linear-gradient(45deg, white, #f8f9fa);
  }
  
  .exam-timer i {
    font-size: 1.4em;
    color: var(--primary);
  }
  
  .main-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    margin-top: 2rem;
  }
  
  .section {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  .question {
    margin-bottom: 2rem;
    padding: 1rem;
    border-right: 4px solid var(--primary);
    background: rgba(43, 77, 126, 0.1);
  }
  
  .record-button {
    background: var(--secondary);
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    margin: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: linear-gradient(45deg, var(--secondary), #45a049);
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
  }
  
  .record-button i {
    font-size: 1.2em;
  }
  
  .record-button.recording {
    background: linear-gradient(45deg, #f44336, #d32f2f);
    box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
  }
  
  .delete-button {
    background: #f44336;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    margin-left: 1rem;
    display: flex;
    align-items: center;
    gap: 4px;
    background: linear-gradient(45deg, #f44336, #d32f2f);
    box-shadow: 0 4px 15px rgba(244, 67, 54, 0.2);
  }
  
  .delete-button i {
    font-size: 1em;
  }
  
  .timer {
    font-size: 1.5rem;
    text-align: center;
    margin: 1rem 0;
  }
  
  .progress-bar {
    width: 100%;
    height: 10px;
    background: #ddd;
    border-radius: 5px;
    overflow: hidden;
    margin: 1rem 0;
  }
  
  .progress {
    height: 100%;
    background: var(--primary);
    width: 0%;
    transition: width 0.3s ease;
  }
  
  .score-display {
    margin: 1rem 0;
    padding: 1rem;
    background: rgba(76, 175, 80, 0.1);
    border-radius: 4px;
  }
  
  .youtube-container {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
    margin-bottom: 1rem;
  }
  
  .youtube-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
  
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  
  .section-nav {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin: 2rem 0;
  }
  
  .section-button {
    background: var(--primary);
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 8px;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.3s;
    display: flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(45deg, var(--primary), #1a365d);
    box-shadow: 0 4px 15px rgba(43, 77, 126, 0.2);
  }
  
  .section-button i {
    font-size: 1.2em;
  }
  
  .section-button.active {
    opacity: 1;
  }
  
  .recording-segments {
    display: flex;
    gap: 1rem;
    margin: 1rem 0;
  }
  
  .segment {
    padding: 0.5rem;
    background: #eee;
    border-radius: 4px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(45deg, #f5f5f5, #e9ecef);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .admin-panel {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-top: 2rem;
  }
  
  .question-editor {
    margin: 1rem 0;
    padding: 1rem;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .question-editor textarea {
    width: 100%;
    min-height: 100px;
    margin: 0.5rem 0;
    padding: 0.5rem;
    font-size: 16px;
  }
  
  .save-button {
    background: var(--secondary);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(45deg, var(--secondary), #45a049);
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
  }
  
  .save-button i {
    font-size: 1.2em;
  }
  
  .sidebar {
    position: fixed;
    right: 0; 
    top: 0;
    height: 100vh;
    width: 200px;
    background: white;
    padding: 2rem;
    border-left: 1px solid #ddd; 
    box-shadow: -2px 0 4px rgba(0,0,0,0.1); 
  }
  
  .sidebar-nav {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  
  .sidebar-button {
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.8rem;
    border-radius: 4px;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.3s;
    text-align: right;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 8px;
    background: linear-gradient(45deg, var(--primary), #1a365d);
    box-shadow: 0 4px 15px rgba(43, 77, 126, 0.2);
  }
  
  .sidebar-button i {
    font-size: 1.2em;
  }
  
  .sidebar-button.active {
    opacity: 1;
  }
  
  .recording-player {
    margin: 1rem 0;
    padding: 1rem;
    background: #f5f5f5;
    border-radius: 4px;
  }
  
  .audio-player {
    width: 100%;
    margin: 0.5rem 0;
    border-radius: 4px;
    background: rgba(43, 77, 126, 0.1);
    padding: 0.5rem;
  }
  
  .recording-timer {
    text-align: center;
    font-size: 1.2rem;
    margin: 0.5rem 0;
    color: var(--primary);
  }
  
  .recording-error {
    color: #f44336;
    margin: 0.5rem 0;
  }
  
  .admin-button {
    position: fixed;
    top: 20px;
    left: 20px; 
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(45deg, var(--primary), #1a365d);
    box-shadow: 0 4px 15px rgba(43, 77, 126, 0.2);
  }
  
  .admin-button i {
    font-size: 1.2em;
  }
  
  .admin-button:hover {
    background: var(--secondary);
  }
  
  .access-request-screen {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
    text-align: center;
    max-width: 500px;
    margin: 2rem auto;
  }
  
  .access-request-screen p {
    margin: 1rem 0;
  }
  
  .access-request-screen a {
    color: var(--primary);
    text-decoration: none;
    margin-right: 0.5rem;
  }
  
  .access-request-screen a:hover {
    text-decoration: underline;
  }
  
  .login-container {
    max-width: 400px;
    margin: 2rem auto;
    padding: 2rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  .login-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 400px;
    margin: 2rem auto;
    padding: 2rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    text-align: center;
  }
  
  .login-form h3 {
    margin-bottom: 2rem;
  }
  
  .login-form {
    text-align: right;
  }
  
  .access-request-screen {
    text-align: right;
  }
  
  .form-group {
    text-align: right;
  }
  
  .form-group label {
    text-align: right;
  }
  
  .request-access-button {
    text-align: center;
  }
  
  .google-form-container {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  .return-button {
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.8rem 1.5rem;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 1rem;
  }
  
  /* Add new mobile responsive CSS */
  @media screen and (max-width: 768px) {
    .container {
      padding: 10px;
      padding-top: 60px;
      padding-right: 10px; /* Remove sidebar padding on mobile */
    }
  
    .main-content {
      grid-template-columns: 1fr; /* Stack content vertically on mobile */
      gap: 1rem;
    }
  
    .exam-timer {
      right: 10px;
      width: 120px;
      font-size: 0.9em;
      padding: 0.5rem;
    }
  
    .sidebar {
      display: none; /* Hide sidebar on mobile */
    }
  
    .section-nav {
      flex-direction: column;
      gap: 0.5rem;
    }
  
    .section-button {
      width: 100%;
      padding: 0.8rem;
      font-size: 0.9em;
    }
  
    .recording-segments {
      flex-direction: column;
    }
  
    .segment {
      width: 100%;
    }
  
    .admin-button {
      top: 10px;
      left: 10px;
      font-size: 0.9em;
      padding: 0.4rem 0.8rem;
    }
  
    .welcome-screen {
      padding: 1rem;
    }
  
    .login-form {
      padding: 0 1rem;
    }
  
    /* Update form elements for better mobile experience */
    .form-group input {
      font-size: 16px; /* Prevent iOS zoom on input focus */
      padding: 0.8rem;
    }
  
    .record-button {
      width: 100%;
      margin: 0.5rem 0;
    }
  
    .youtube-container {
      margin: 1rem 0;
    }
  
    /* Make admin panel mobile friendly */
    .admin-panel {
      padding: 1rem;
    }
  
    .question-editor {
      padding: 0.5rem;
    }
  
    .question-editor textarea {
      font-size: 16px;
    }
  
    /* Add mobile menu button */
    .mobile-menu-button {
      position: fixed;
      right: 10px;
      bottom: 20px;
      background: var(--primary);
      color: white;
      border: none;
      padding: 1rem;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2); 
      z-index: 1000;
      cursor: pointer;
    }
  
    /* Mobile navigation menu */
    .mobile-nav {
      position: fixed;
      bottom: 90px;
      right: 10px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      padding: 1rem;
      z-index: 999;
    }
  
    .mobile-nav button {
      width: 100%;
      margin: 0.5rem 0;
      text-align: right;
    }
  }
  </style>
  
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossOrigin="anonymous" w-tid="10"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossOrigin="anonymous" w-tid="11"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js" crossOrigin="anonymous" w-tid="12"></script>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap" rel="stylesheet" w-tid="13"/>
  </head>
  <body w-tid="14">
  <div id="root" w-tid="15"></div>
  
  <script type="text/babel" w-tid="16">const AccessRequestScreen = ({
    onAccessRequestSent
  }) => {
    const [formData, setFormData] = React.useState({
      email: ''
    });
    React.useEffect(() => {
      const params = new URLSearchParams(window.location.search);
      const action = params.get('action');
      const email = params.get('email');
      const id = params.get('id');
      if (action === 'approve' && email && id) {
        const approvedEmails = JSON.parse(localStorage.getItem('approvedEmails') || '[]');
        if (!approvedEmails.includes(email)) {
          const newApprovedEmails = [...approvedEmails, email];
          localStorage.setItem('approvedEmails', JSON.stringify(newApprovedEmails));
          alert('בקשת הגישה אושרה בהצלחה! המשתמש יכול כעת להיכנס למערכת');
        }
        window.history.replaceState({}, '', window.location.pathname);
      }
    }, []);
    const checkAccess = async email => {
      try {
        const approvedEmails = JSON.parse(localStorage.getItem('approvedEmails') || '[]');
        if (approvedEmails.includes(email)) {
          onAccessRequestSent(true);
        } else {
          alert('האימייל שלך עדיין לא אושר. אנא בקש גישה דרך הטופס.');
        }
      } catch (error) {
        alert('אירעה שגיאה בבדיקת הגישה');
      }
    };
    return <div className="access-request-screen">
        <h1>כניסה למערכת</h1>
        <div className="form-group">
          <label>אימייל</label>
          <input type="email" required value={formData.email} onChange={e => setFormData({
          ...formData,
          email: e.target.value
        })} />
        </div>
        <button onClick={() => checkAccess(formData.email)} className="start-button">
          כניסה
        </button>
        <p>
          אין לך גישה עדיין? 
          <a href="https://docs.google.com/forms/d/e/1FAIpQLSezxd5AJFxgcLQ2En6jHfNbP5JsAvWZBUBM4HC77EewdlgAGw/viewform" target="_blank" rel="noopener noreferrer">
            בקש גישה כאן
          </a>
        </p>
      </div>;
  };
  const AdminPanel = ({
    onUpdateQuestions,
    onBack
  }) => {
    const [questions, setQuestions] = React.useState({
      section1: ["שאלה 1", "שאלה 2"],
      section2: ["שאלה 3", "שאלה 4"],
      section3: ["שאלה 5", "שאלה 6"]
    });
    const [videoUrl, setVideoUrl] = React.useState('');
    React.useEffect(() => {
      const savedVideoUrl = localStorage.getItem('examVideoUrl');
      if (savedVideoUrl) {
        setVideoUrl(savedVideoUrl);
      }
    }, []);
    const handleQuestionChange = (section, index, value) => {
      const newQuestions = {
        ...questions
      };
      newQuestions[section][index] = value;
      setQuestions(newQuestions);
    };
    const addQuestion = section => {
      const newQuestions = {
        ...questions
      };
      newQuestions[section] = [...newQuestions[section], "שאלה "];
      setQuestions(newQuestions);
    };
    const removeQuestion = (section, index) => {
      const newQuestions = {
        ...questions
      };
      newQuestions[section] = newQuestions[section].filter((_, i) => i !== index);
      setQuestions(newQuestions);
    };
    const handleSave = () => {
      let processedVideoUrl = videoUrl;
      if (videoUrl) {
        const youtubeRegex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
        const match = videoUrl.match(youtubeRegex);
        if (match && match[1]) {
          processedVideoUrl = `https://www.youtube.com/embed/${match[1]}`;
        } else {
          alert('שגיאה: קישור לוידאו לא תקין.');
          return;
        }
      }
      localStorage.setItem('examQuestions', JSON.stringify(questions));
      localStorage.setItem('examVideoUrl', processedVideoUrl);
      onUpdateQuestions(questions);
      alert('נשמר בהצלחה!');
    };
    return <div className="admin-panel">
        <button className="sidebar-button" style={{
        marginBottom: '20px'
      }} onClick={onBack}>
          <i className="fas fa-arrow-right" />
          חזור
        </button>
  
        <h2>ערוך שאלות</h2>
  
        <div style={{
        marginBottom: '2rem'
      }}>
          <h3>קישור לוידאו</h3>
          <div className="form-group">
            <input type="text" value={videoUrl} onChange={e => setVideoUrl(e.target.value)} placeholder="https://www.youtube.com/watch?v=VIDEO_ID" style={{
            width: '100%',
            padding: '0.5rem'
          }} />
            <small style={{
            display: 'block',
            marginTop: '0.5rem',
            color: '#666'
          }}>
            קישור לוידאו:
            <br />
            - https://www.youtube.com/watch?v=VIDEO_ID
            <br />
            - https://youtu.be/VIDEO_ID
            <br />
            - https://www.youtube.com/embed/VIDEO_ID
          </small>
        </div>
      </div>
  
        {Object.entries(questions).map(([section, sectionQuestions]) => <div key={section} className="question-editor">
            <h3>מדור {section.replace('section', '')}</h3>
            {sectionQuestions.map((question, index) => <div key={index} style={{
          display: 'flex',
          gap: '1rem',
          marginBottom: '1rem'
        }}>
                <textarea value={question} onChange={e => handleQuestionChange(section, index, e.target.value)} style={{
            flex: 1
          }} />
                <button onClick={() => removeQuestion(section, index)} className="delete-button">
                  <i className="fas fa-trash" />
                  מחק
                </button>
              </div>)}
            <button onClick={() => addQuestion(section)} className="save-button" style={{
          marginTop: '1rem'
        }}>
              <i className="fas fa-plus" />
              הוסף שאלה
            </button>
          </div>)}
        <button className="save-button" onClick={handleSave}>
          <i className="fas fa-save" />
          שמור
        </button>
      </div>;
  };
  const ExamApp = () => {
    const [started, setStarted] = React.useState(false);
    const [studentInfo, setStudentInfo] = React.useState(null);
    const [currentSection, setCurrentSection] = React.useState(1);
    const [examTimer, setExamTimer] = React.useState(30 * 60);
    const [isAdmin, setIsAdmin] = React.useState(false);
    const [hasAccess, setHasAccess] = React.useState(false);
    const [showAccessRequest, setShowAccessRequest] = React.useState(true);
    const [questions, setQuestions] = React.useState({
      section1: ["שאלה 1", "שאלה 2"],
      section2: ["שאלה 3", "שאלה 4"],
      section3: ["שאלה 5", "שאלה 6"]
    });
    const [videoUrl, setVideoUrl] = React.useState('');
    const [mobileMenuOpen, setMobileMenuOpen] = React.useState(false);
    const [windowWidth, setWindowWidth] = React.useState(window.innerWidth);
    React.useEffect(() => {
      const params = new URLSearchParams(window.location.search);
      const action = params.get('action');
      const email = params.get('email');
      const id = params.get('id');
      if (action === 'approve' && email && id) {
        const approvedEmails = JSON.parse(localStorage.getItem('approvedEmails') || '[]');
        if (!approvedEmails.includes(email)) {
          const newApprovedEmails = [...approvedEmails, email];
          localStorage.setItem('approvedEmails', JSON.stringify(newApprovedEmails));
          alert('בקשת הגישה אושרה בהצלחה! המשתמש יכול כעת להיכנס למערכת');
        }
        window.history.replaceState({}, '', window.location.pathname);
      }
    }, []);
    const checkAccess = async email => {
      const approvedEmails = JSON.parse(localStorage.getItem('approvedEmails') || '[]');
      return approvedEmails.includes(email);
    };
    const handleAccessRequestSent = async email => {
      if (await checkAccess(email)) {
        setHasAccess(true);
        setShowAccessRequest(false);
      }
    };
    const handleStart = formData => {
      setStudentInfo(formData);
      setStarted(true);
    };
    const handleAdminExit = () => {
      setIsAdmin(false);
    };
    const toggleAdmin = () => {
      setIsAdmin(true);
    };
    return <div>
        {isAdmin ? <AdminPanel onUpdateQuestions={setQuestions} onBack={handleAdminExit} /> : !hasAccess ? <AccessRequestScreen onAccessRequestSent={handleAccessRequestSent} /> : !started ? <WelcomeScreen onStart={handleStart} /> : <div>
            {windowWidth <= 768 && <React.Fragment>
                <button className="mobile-menu-button" onClick={() => setMobileMenuOpen(!mobileMenuOpen)}>
                  <i className="fas fa-bars" />
                </button>
                {mobileMenuOpen && <div className="mobile-nav">
                  </div>}
              </React.Fragment>}
          </div>}
      </div>;
  };
  const WelcomeScreen = ({
    onStart
  }) => {
    const [formData, setFormData] = React.useState({
      name: '',
      class: '',
      teacher: '',
      email: ''
    });
    const handleSubmit = e => {
      e.preventDefault();
      onStart(formData);
    };
    return <div className="welcome-screen">
        <h1>ISpeak - ^2&#x5d1;2&#x5e8;2&#x5d9;4&#x5ea; &#x5de;&#x5e2;&#x5e8;&#x5db;&#x5ea;</h1>
        <p>
          ^2&#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea;, &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea;.
        </p>
        <p>
          &#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea;.
        </p>
        <p>
          &#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea;.
        </p>
        <p>
          &#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15e2;&#x15d5;&#x15e8;&#x15d5;&#x15ea; &#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15ea;!
        </p>
        <form className="login-form" onSubmit={handleSubmit}>
          <div className="form-group">
            <label>&#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8;</label>
            <input type="text" required value={formData.name} onChange={e => setFormData({
            ...formData,
            name: e.target.value
          })} />
          </div>
          <div className="form-group">
            <label>&#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15e8;</label>
            <input type="text" required value={formData.class} onChange={e => setFormData({
            ...formData,
            class: e.target.value
          })} />
          </div>
          <div className="form-group">
            <label>&#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8; </label>
            <input type="text" required value={formData.teacher} onChange={e => setFormData({
            ...formData,
            teacher: e.target.value
          })} />
          </div>
          <div className="form-group">
            <label>&#x591;&#x5d9;&#x5dd;</label>
            <input type="email" required value={formData.email} onChange={e => setFormData({
            ...formData,
            email: e.target.value
          })} />
          </div>
          <button type="submit" className="start-button">&#x15d0;&#x15d5;&#x15e8;&#x15d5;&#x15e8; </button>
        </form>
        <button className="request-access-button">
          &#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8; &#x15e9;&#x15d0;&#x15e8;&#x15d5;&#x15e8;
        </button>
      </div>;
  };
  const RecordingSection = ({
    question,
    onRecord,
    recordings
  }) => {
    const [segments, setSegments] = React.useState([]);
    const [isRecording, setIsRecording] = React.useState(false);
    const [recordingTime, setRecordingTime] = React.useState(0);
    const [errorMessage, setErrorMessage] = React.useState('');
    const [combinedAudioUrl, setCombinedAudioUrl] = React.useState('');
    const mediaRecorderRef = React.useRef(null);
    const chunksRef = React.useRef([]);
    React.useEffect(() => {
      let interval;
      if (isRecording) {
        interval = setInterval(() => {
          setRecordingTime(prev => prev + 1);
        }, 1000);
      }
      return () => {
        if (interval) {
          clearInterval(interval);
        }
      };
    }, [isRecording]);
    React.useEffect(() => {
      const updateCombinedAudio = async () => {
        if (segments.length > 0) {
          try {
            const audioElements = await Promise.all(segments.map(async seg => {
              const response = await fetch(seg.url);
              const blob = await response.blob();
              return blob;
            }));
            const combinedBlob = new Blob(audioElements, {
              type: 'audio/webm'
            });
            const url = URL.createObjectURL(combinedBlob);
            setCombinedAudioUrl(url);
          } catch (error) {
            console.error('Error combining audio segments:', error);
            setErrorMessage('Error combining audio segments');
          }
        } else {
          setCombinedAudioUrl('');
        }
      };
      updateCombinedAudio();
    }, [segments]);
    const startRecording = async () => {
      if (segments.length >= 2) {
        setErrorMessage('לא ניתן לבצע יותר משני הקלטות.');
        return;
      }
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          audio: true
        });
        mediaRecorderRef.current = new MediaRecorder(stream);
        chunksRef.current = [];
        mediaRecorderRef.current.ondataavailable = e => {
          chunksRef.current.push(e.data);
        };
        mediaRecorderRef.current.onstop = () => {
          const blob = new Blob(chunksRef.current, {
            type: 'audio/webm'
          });
          const url = URL.createObjectURL(blob);
          setSegments(prev => [...prev, {
            id: Date.now(),
            url,
            duration: recordingTime
          }]);
          setRecordingTime(0);
          setErrorMessage('');
        };
        mediaRecorderRef.current.start();
        setIsRecording(true);
        setErrorMessage('');
      } catch (err) {
        console.error('Error accessing microphone:', err);
        setErrorMessage('שגיאה בגישה למיקרופון.');
      }
    };
    const stopRecording = () => {
      mediaRecorderRef.current.stop();
      setIsRecording(false);
      setErrorMessage('');
    };
    const deleteSegment = segmentId => {
      setSegments(prev => prev.filter(seg => seg.id !== segmentId));
      setErrorMessage('');
    };
    return <div className="question">
        <p>{question}</p>
        
        {isRecording ? <div>
            <div className="recording-timer">
              זמן הקלטה: {recordingTime} שניות
            </div>
            <button className="record-button recording" onClick={stopRecording}>
              <i className="fas fa-stop-circle" />
              עצור
            </button>
          </div> : <button className="record-button" onClick={startRecording} disabled={segments.length >= 2}>
            <i className={isRecording ? "fas fa-stop-circle" : "fas fa-microphone"} />
            {isRecording ? 'עצור' : 'הקלט'}
          </button>}
  
        {errorMessage && <div className="recording-error">{errorMessage}</div>}
  
        <div className="recording-segments">
          {segments.map((segment, index) => <div key={segment.id} className="segment">
              <i className="fas fa-headphones" />
              <span>הקלטה {index + 1}</span>
              <audio className="audio-player" controls src={segment.url} />
              <button className="delete-button" onClick={() => deleteSegment(segment.id)}>
                <i className="fas fa-trash" />
                מחק
              </button>
            </div>)}
        </div>
  
        {segments.length > 0 && <div className="recording-player">
            <h4>הקלטה מאוחדת</h4>
            <audio className="audio-player" controls src={combinedAudioUrl} />
          </div>}
      </div>;
  };
  ReactDOM.render(<ExamApp />, document.getElementById('root'));</script>
  
  </body>
  </html>